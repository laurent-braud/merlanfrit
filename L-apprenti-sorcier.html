<html><link rel="stylesheet" type="text/css" href="style.css" /><body><div class="container"><p class="menu"><a href="index.html">Index</a></p><h1>L'apprenti sorcier</h1><p class="auteur">par Laurent Braud</p><p class="info">22/11/2012</p><div class="chapo"><p>Les ordinateurs ne dominent pas encore le monde, mais c'est pour bientôt, c'est connu. Le monde tremble depuis que des programmes maîtrisent Othello, qu'ils sont devenus les maîtres des échecs après la bataille de Kasparov-Deep Blue en 1996. Les humains rescapés se sont réfugiés dans des jeux aux possibilités plus grandes, comme le go, ou ... les cartes <i>Magic</i>, inventées en 1993 par Richard Garfield, et qui sortent de façon ininterrompue depuis. Pourtant, ce ne sont pas les tentatives qui manquent d'implémenter un joueur artificiel pour le produit phare de Wizards of the Coast. Petit <a href="http://magiccards.info/rtr/en/134.html">tour d'horizon</a>.</p></div><p>Décrire les règles de <i>Magic</i> rappelle un peu la situation du narrateur du <i><a href="http://fr.wikipedia.org/wiki/Le_Jeu_des_perles_de_verre">Jeu des perles de verre</a></i> : on peut en donner une définition grossière, mais impossible d'en résumer simplement toutes les subtilités, les raisons qui en font un jeu de société exceptionnel. Esquissons tout de même les principes ; ceux qui veulent plus de détails iront voir les <a href="http://www.wizards.com/Magic/TCG/Article.aspx?x=mtg/tcg/newtomagic/learntoplay">tutoriaux officiels</a>.</p><p>À chaque tour, le joueur a le droit de poser un <i>terrain</i>, qui lui donne un mana d'une certaine couleur (sur cinq en tout). Cette ressource lui permet d'acheter des <i>créatures</i>, qu'il lance à l'attaque contre l'autre joueur. L'adversaire peut bloquer cette attaque avec ses propres créatures grâce à un système simple de force/endurance. On peut également poser d'autres cartes qui ne sont pas des créatures (<i>artefacts</i>, <i>enchantements</i>, <i>planeswalkers</i>), et lancer
des sorts ponctuels (<i>rituels</i> et <i>éphémères</i>) au bon moment pour influencer la partie. La complexité tient au fait que chaque carte ajoute généralement une règle ou plus, voire modifie complètement un aspect du jeu. Chaque extension, au rythme de trois par an plus un <i>"core set"</i>, apporte son lot de méchanismes nouveaux, comme les <a href="http://magiccards.info/isd/en/182a.html">cartes recto-verso</a> en 2012. Au total, il y a <a href="http://gatherer.wizards.com/Pages/Search/Default.aspx?format=|%5b%22Vintage%22%5d">plus de 9000 cartes</a> autorisées en tournoi<span id="upnote1"><sup><a href="#note1">1</a></sup></span>. </p><p>Jeu aux nombreuses règles, univers <i>fantasy</i> : le créneau vidéoludique est tout trouvé, l'ordinateur aidant à gérer toutes les règles &mdash; qui se raffinent depuis des années, et changent encore régulièrement ; être juge de <i>Magic</i> n'est pas une sinécure. Le développement n'est toutefois pas si simple. Sans même parler d'une I.A. capable de jouer à <i>Magic</i>, la seule implémentation des règles du jeu est déjà difficile. Pour commencer, il n'existe (à ma connaissance) aucune plate-forme virtuelle proposant toutes les cartes physiques, même sur le logiciel officiel, <i>Magic : the Gathering Online</i>. </p><p>Plus grave, aucune n'implémente non plus complètement les règles, notamment celle qui concernent les <a href="http://yawgatog.com/resources/magic-rules/#R716">boucles infinies</a> qui peuvent survenir. Il arrive en effet des cas<span id="upnote2"><sup><a href="#note2">2</a></sup></span> où un joueur peut répéter une suite d'actions un nombre arbitraire de fois, et les règles spécifient bien qu'il a le droit de donner un nombre aussi grand qu'il veut. Cette notion est difficile à encoder dans une interface déjà chargée. Ce premier problème explique l'apparition de certaines plateformes (<i>Cockatrice</i>, <i>Magic Workstation</i>) qui n'appliquent aucune règle et laissent les joueurs responsables de la partie, se contentant de fournir le réseau social.</p><p><h2><i>Shandalar</i>, l'ancêtre</h2></p><p>D'accord, il est raisonnable d'ignorer quelques règles très spécifiques, et de limiter le nombre de cartes. En 1997, alors que la <i>hype</i> de <i>Magic</i> commence à battre son plein, Wizards of the Coast  juge encore trop complexe le développement d'une plateforme multijoueur. L'éditeur demande donc à MicroProse de créer un jeu solo, <i>Shandalar</i> (officiellement tout simplement <i>Magic : the Gathering</i>). Cette toute première représentation virtuelle du jeu marque les esprits pour plusieurs raisons. C'est le seul cas qui ne se limite pas au jeu de cartes : le joueur contrôle un personnage qui explore un monde (non sans similarités avec <i><a href="http://www.mobygames.com/game/dos/darklands">Darklands</a></i> du même MicroProse), doit régulièrement acheter à manger, explorer des donjons, accomplir des mini-quêtes. </p><p>Même la partie jeu de carte a subi des interprétations : les matchs se font en misant une carte (un système originel de Magic abandonné depuis longtemps) ; le nombre de points de vie n'est pas fixé à 20 comme dans les règles officielles, mais varie selon l'ennemi. Et surtout, le jeu contient toutes les <a href="http://wiki.mtgsalvation.com/article/Power_Nine">cartes les plus puissantes</a> de Magic à l'époque et donc non seulement interdites dans la plupart des compétitions, mais même jamais rééditées et inaccessibles pour la plupart des joueurs.</p><p>Comme attendu, l'I.A. du jeu est souvent dépassée et elle ne fait jamais le poids à <i>deck</i> égal, à moins d'un coup de chance. Le jeu a cependant une difficulté élevée : les <i>decks</i> de départ sont boiteux et mal fichus, et on ne commence qu'avec très peu de points de vie ; les donjons contiennent des effets continus qui avantagent nettement les adversaires ; le fait que l'on mise  à chaque match interdit d'en perdre trop à la suite, surtout lorsque l'on commence à avoir de bonnes cartes. A côté de ça, l'aspect "grosbill" du jeu, avec ses cartes surpuissantes qu'on ne voit jamais d'habitude, est très jouissif et de toute façon nécessaire : le boss final a plusieurs centaines de points de vie et un <i>deck</i> plutôt corsé. Pour finir le jeu, il faut donc mettre au point une combinaison de cartes interdisant pratiquement au boss de jouer. Ce n'est pas là du <i>Magic</i> tel qu'on le joue dans les boutiques de jeu de société.</p><p>Quelques années après le succès de <i>Shandalar</i>, de nombreux projets se lancent pour ajouter de nouvelles cartes et améliorer l'I.A.. Abandonnant la partie promenade dans les bois, <i>Manalink</i> (actuellement à la version 3.0) ajoute des cartes et un mode multijoueur. D'autres projets aux noms permutables fleurissent avec l'idée de tout recommencer depuis le début : <i>Wagic</i>, <i>MagMa</i>, <i>Magarena</i>, <i>MAGE</i>, <i>Forge</i><span id="upnote3"><sup><a href="#note3">3</a></sup></span>... parmi ceux-ci, <i><a href="http://mtgrares.blogspot.fr/">Forge</a></i> &mdash; au développement arrêté, même si les nouvelles cartes seront mises à jour &mdash; propose un mode "aventure" intéressant où l'on peut faire évoluer son deck. </p><p><h2>L'insurmontable complexité</h2></p><p>Dans <a href="http://mtgrares.blogspot.fr">son blog</a>, le développeur de <i>Forge</i> explique les choix qu'il est amené à faire. <a href="http://mtgrares.blogspot.fr/2012/02/browsing-forges-source-code-part-deux.html">Par exemple</a>, la carte <a href="http://magiccards.info/fut/en/126.html">Force de sauvagerie</a> est une créature qui a une endurance de zéro. Il est donc inutile de la jouer, puisqu'elle meurt instantanément, sauf s'il y a une autre carte sur la table dont l'effet est de relever son endurance immédiatement, comme une <a href="http://magiccards.info/query?q=antienne+o%3A%22%2B1%2F%2B1%22&v=card&s=cname">Antienne</a>. Le développeur demande donc à l'I.A. de vérifier d'abord la présence d'une de ces cartes avant de jouer la Force de Sauvagerie. Ce sera effectivement un moyen fréquent de la jouer, mais un joueur un peu expérimenté de <i>Magic</i> pourrait donner dix autres moyens de la jouer efficacement : la solution est donc bancale, compromis entre efficacité et simplicité.</p><p>Plutôt que ces solutions <i>ad hoc</i>, on imaginerait donc bien un algorithme plus général. Mais les possibilités sont bien trop grandes. Je peux jouer un <i>éphémère</i> (une <a href="http://magiccards.info/m11/en/149.html">Foudre</a>, par exemple) à n'importe quel moment &mdash; 10 fois par tour &mdash; et peux alors cibler n'importe quoi (joueur, créature, et je peux avoir des raisons de viser dans mon camp). Chaque choix n'a pas les mêmes conséquences selon l'endurance et les particularités de chaque créature ; enfin, il peut déclencher une série de réponses différentes selon les capacités de chaque carte en jeu. Si j'ai maintenant deux sorts, il faut multiplier les possibilités, et même plus, puisque l'ordre dans lequel je les joue &mdash; si je les joue tous les deux &mdash; change encore une fois le résultat. </p><p>Tout ceci sans même considérer le fait que l'information est partielle : l'adversaire a-t-il dans sa main de quoi contrer mon sort ? Va-t-il jouer une créature plus dangereuse dans les prochains tours, auquel cas je ferais mieux d'attendre ? De mon côté, est-ce que j'envisage au prochain tour d'utiliser toute ma réserve de mana, me privant de la possibilité de jouer ma Foudre &mdash; il vaudrait donc mieux la jouer maintenant ? Le choix possible d'un seul coup est donc énorme, bien plus grand qu'aux échecs ; et pour simuler une réflexion, l'algorithme devrait explorer l'arbre des coups possibles de part et d'autres &mdash; en faisant des suppositions sur l'information inconnue : pioche, main et deck de l'adversaire. L'explosion exponentielle de cet arbre vient alors rapidement à bout des faibles calculateurs de silicium, là où l'humain sait faire un tri instantané. </p><p><h2><i>Duels of the Planeswalkers</h2></i></p><p>Devant l'ampleur de cette difficulté, Wizards choisit en 2009 d'implémenter (via Stainless Games) la stratégie inverse des projets qui précèdent : la simplicité. Dans <i>Duels of the Planeswalkers</i>, les joueurs n'ont pas la possibilité de composer leurs propres decks. Ceux-ci sont pré-établis, les cartes choisies sont simples, et ils pratiquement tous monocouleurs (une seule ressource dans chacun). Les règles sont également largement assouplies. Ces contraintes ont permis de construire une I.A. très correcte, à quelques erreurs près. Le jeu est régulièrement actualisé et remis en vente avec de nouveaux <i>decks</i>, d'où une version <i>2012</i> et <i>2013</i>, auxquelles s'ajoutent quelques extensions (encore de nouveaux decks).</p><p>Le choix de Wizards en vaut-il la chandelle ? De leur point de vue, oui : <i>DotP</i> est ouvertement une simple porte vers le jeu physique, un tutoriel pour apprendre à jouer, d'où son prix faible et sa simplicité. En cela, il est effectivement excellent et doit probablement attirer de nombreux joueurs dans les filets du lucratif système Wizards. Pour un <i>addict</i> déjà confirmé, par contre, il est difficile d'y trouver de l'intérêt. La quasi-absence de <i>deckbuilding</i> supprime la moitié de l'exercice et du plaisir. La plupart des matches ne propose pas de vrai choix et se joue sans réfléchir. Parfois même l'adversaire a un deck complètement absurde &mdash; comme celui qui propose 20 fois <a href="http://magiccards.info/mi/en/280.html">Guet des nuages</a> + <a href="http://magiccards.info/eve/en/68.htmlhelix pinnacle">Pinacle de l'hélice</a> + une créature pour bloquer (alors que les règles interdisent plus de 4 fois la même carte) &mdash; et on réprime alors difficilement un Alt-F4 rageur. Le titre se sauve en proposant des "défis", c'est-à-dire des puzzles, des situations préconstruites où il faut trouver la bonne combinaison d'actions. Contraint à l'extrême, le jeu réagit alors comme il faut.</p><p>En matière de joueur artificiel, on se retrouve donc devant un dilemme classique : si l'on soumet le jeu à de fortes contraintes, il est possible de construire des réponses efficaces, mais le joueur ne s'y amuse pas vraiment ; si l'on laisse trop de liberté au joueur, l'ordinateur ne sait plus jouer. Finalement, la seconde possibilité reste la plus viable, si l'on sait s'adapter. Car malgré tous ses défauts, <i>Shandalar</i> reste la référence en matière de jeu vidéo tiré de <i>Magic</i>, parce qu'il propose une expérience alternative à partir du principe de base, expérience que le mode aventure de <i>Forge</i> ravive presque. Malheureusement, la recherche de l'originalité de la part de Wizards n'a produit récemment qu'un l'abominable <a href="http://www.magicthegatheringtactics.com/">clone de <i>Heroes of Might and Magic</i></a> qui n'a de Magic que le nom. Les dernières extensions du jeu de cartes ont initié le retour vers des plans déjà visités précédemment (<a href="http://wiki.mtgsalvation.com/article/Mirrodin_(plane)">Mirrodin</a>, <a href="http://wiki.mtgsalvation.com/article/Ravnica">Ravnica</a>). N'est-il pas temps de revenir sur <i><a href="http://wiki.mtgsalvation.com/article/Shandalar">Shandalar</a></i> ?</p><div class="ps"><p>Ça ne marche pas bien, mais on en veut quand même :
<br/>&emsp;&mdash;&nbsp; Une <a href="http://www.slightlymagic.net/wiki/List_of_MTG_Engines">liste de logiciels magiques</a> non-officiels.
<br/>&emsp;&mdash;&nbsp; <i>Shandalar</i> a subi un petit lifting pas désagréable. Le résultat est <a href="http://www.slightlymagic.net/forum/viewtopic.php?f=76&t=7342">téléchargeable ici</a>.</p></div><ul class="notes"><li id="note1"><a href="#upnote1">&uarr;</a>1. D'autres chiffres sont parfois avancés : ils prennent en compte les cartes aujourd'hui bannies, les éditions parodiques, les cartes de grande taille pour multijoueur, pour un total supérieur à 11000. Si on compte les éditions séparées, on arrive encore plus haut, bien sûr.</li><li id="note2"><a href="#upnote2">&uarr;</a>2. Un exemple : la <a href="http://magiccards.info/shm/en/110.html">Druidesse dévouée</a> prend des marqueurs -1/-1 et donne du mana vert. Au bout de 2 marqueurs, son endurance est de 0, donc elle finit par mourir : mais <a href="http://magiccards.info/dka/en/70.html">Mikaeus, le maudit</a> la fait revivre en lui rajoutant un compteur +1/+1 (qui s'annule avec les -1/-1). En répétant cette opération <i>X</i> fois, le joueur obtient <i>X</i> mana, de façon illimitée.</li><li id="note3"><a href="#upnote3">&uarr;</a>3. <i>Disclaimer</i> : je n'ai pas essayé tous les logiciels cités ici.</li></ul></div></body></html>